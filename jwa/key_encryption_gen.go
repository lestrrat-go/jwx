// Code generated by tools/cmd/genjwa/main.go. DO NOT EDIT.

package jwa

import (
	"encoding/json"
	"fmt"
	"sort"
	"sync"
)

var muAllKeyEncryptionAlgorithm sync.RWMutex
var allKeyEncryptionAlgorithm = map[string]KeyEncryptionAlgorithm{}
var muListKeyEncryptionAlgorithm sync.RWMutex
var listKeyEncryptionAlgorithm []KeyEncryptionAlgorithm
var builtinKeyEncryptionAlgorithm = map[string]struct{}{}

func init() {
	// builtin values for KeyEncryptionAlgorithm
	algorithms := make([]KeyEncryptionAlgorithm, 0, 19)
	for _, alg := range []string{"A128GCMKW", "A128KW", "A192GCMKW", "A192KW", "A256GCMKW", "A256KW", "dir", "PBES2-HS256+A128KW", "PBES2-HS384+A192KW", "PBES2-HS512+A256KW"} {
		algorithms = append(algorithms, NewKeyEncryptionAlgorithm(alg, WithIsSymmetric(true)))
	}

	for _, alg := range []string{"ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW", "RSA1_5", "RSA-OAEP", "RSA-OAEP-256", "RSA-OAEP-384", "RSA-OAEP-512"} {
		algorithms = append(algorithms, NewKeyEncryptionAlgorithm(alg))
	}

	RegisterKeyEncryptionAlgorithm(algorithms...)
}

// A128GCMKW returns the A128GCMKW algorithm object.
func A128GCMKW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("A128GCMKW")
}

// A128KW returns the A128KW algorithm object.
func A128KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("A128KW")
}

// A192GCMKW returns the A192GCMKW algorithm object.
func A192GCMKW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("A192GCMKW")
}

// A192KW returns the A192KW algorithm object.
func A192KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("A192KW")
}

// A256GCMKW returns the A256GCMKW algorithm object.
func A256GCMKW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("A256GCMKW")
}

// A256KW returns the A256KW algorithm object.
func A256KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("A256KW")
}

// DIRECT returns the DIRECT algorithm object.
func DIRECT() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("dir")
}

// ECDH_ES returns the ECDH_ES algorithm object.
func ECDH_ES() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("ECDH-ES")
}

// ECDH_ES_A128KW returns the ECDH_ES_A128KW algorithm object.
func ECDH_ES_A128KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("ECDH-ES+A128KW")
}

// ECDH_ES_A192KW returns the ECDH_ES_A192KW algorithm object.
func ECDH_ES_A192KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("ECDH-ES+A192KW")
}

// ECDH_ES_A256KW returns the ECDH_ES_A256KW algorithm object.
func ECDH_ES_A256KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("ECDH-ES+A256KW")
}

// PBES2_HS256_A128KW returns the PBES2_HS256_A128KW algorithm object.
func PBES2_HS256_A128KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("PBES2-HS256+A128KW")
}

// PBES2_HS384_A192KW returns the PBES2_HS384_A192KW algorithm object.
func PBES2_HS384_A192KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("PBES2-HS384+A192KW")
}

// PBES2_HS512_A256KW returns the PBES2_HS512_A256KW algorithm object.
func PBES2_HS512_A256KW() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("PBES2-HS512+A256KW")
}

// RSA1_5 returns the RSA1_5 algorithm object.
func RSA1_5() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("RSA1_5")
}

// RSA_OAEP returns the RSA_OAEP algorithm object.
func RSA_OAEP() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("RSA-OAEP")
}

// RSA_OAEP_256 returns the RSA_OAEP_256 algorithm object.
func RSA_OAEP_256() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("RSA-OAEP-256")
}

// RSA_OAEP_384 returns the RSA_OAEP_384 algorithm object.
func RSA_OAEP_384() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("RSA-OAEP-384")
}

// RSA_OAEP_512 returns the RSA_OAEP_512 algorithm object.
func RSA_OAEP_512() KeyEncryptionAlgorithm {
	return lookupBuiltinKeyEncryptionAlgorithm("RSA-OAEP-512")
}

func lookupBuiltinKeyEncryptionAlgorithm(name string) KeyEncryptionAlgorithm {
	muAllKeyEncryptionAlgorithm.RLock()
	v, ok := allKeyEncryptionAlgorithm[name]
	muAllKeyEncryptionAlgorithm.RUnlock()
	if !ok {
		panic(fmt.Sprintf(`jwa: KeyEncryptionAlgorithm %q not registered`, name))
	}
	return v
}

type KeyEncryptionAlgorithm struct {
	name        string
	isSymmetric bool
}

func (s KeyEncryptionAlgorithm) String() string {
	return s.name
}

func (s KeyEncryptionAlgorithm) IsSymmetric() bool {
	return s.isSymmetric
}

// EmptyKeyEncryptionAlgorithm returns an empty KeyEncryptionAlgorithm object, used as a zero value
func EmptyKeyEncryptionAlgorithm() KeyEncryptionAlgorithm {
	return KeyEncryptionAlgorithm{}
}

// NewKeyEncryptionAlgorithm creates a new KeyEncryptionAlgorithm object
func NewKeyEncryptionAlgorithm(name string, options ...NewKeyEncryptionAlgorithmOption) KeyEncryptionAlgorithm {
	var isSymmetric bool
	//nolint:forcetypeassert
	for _, option := range options {
		switch option.Ident() {
		case identIsSymmetric{}:
			isSymmetric = option.Value().(bool)
		}
	}
	return KeyEncryptionAlgorithm{name: name, isSymmetric: isSymmetric}
}

// LookupKeyEncryptionAlgorithm returns the KeyEncryptionAlgorithm object for the given name
func LookupKeyEncryptionAlgorithm(name string) (KeyEncryptionAlgorithm, bool) {
	muAllKeyEncryptionAlgorithm.RLock()
	v, ok := allKeyEncryptionAlgorithm[name]
	muAllKeyEncryptionAlgorithm.RUnlock()
	return v, ok
}

// RegisterKeyEncryptionAlgorithm registers a new KeyEncryptionAlgorithm. The signature value must be immutable
// and safe to be used by multiple goroutines, as it is going to be shared with all other users of this library
func RegisterKeyEncryptionAlgorithm(algorithms ...KeyEncryptionAlgorithm) {
	muAllKeyEncryptionAlgorithm.Lock()
	for _, alg := range algorithms {
		allKeyEncryptionAlgorithm[alg.String()] = alg
	}
	muAllKeyEncryptionAlgorithm.Unlock()
	rebuildKeyEncryptionAlgorithm()
}

// UnregisterKeyEncryptionAlgorithm unregisters a KeyEncryptionAlgorithm from its known database.
// Non-existent entries, as well as built-in algorithms will silently be ignored
func UnregisterKeyEncryptionAlgorithm(algorithms ...KeyEncryptionAlgorithm) {
	muAllKeyEncryptionAlgorithm.Lock()
	for _, alg := range algorithms {
		if _, ok := builtinKeyEncryptionAlgorithm[alg.String()]; ok {
			continue
		}
		delete(allKeyEncryptionAlgorithm, alg.String())
	}
	muAllKeyEncryptionAlgorithm.Unlock()
	rebuildKeyEncryptionAlgorithm()
}

func rebuildKeyEncryptionAlgorithm() {
	list := make([]KeyEncryptionAlgorithm, 0, len(allKeyEncryptionAlgorithm))
	muAllKeyEncryptionAlgorithm.RLock()
	for _, v := range allKeyEncryptionAlgorithm {
		list = append(list, v)
	}
	muAllKeyEncryptionAlgorithm.RUnlock()
	sort.Slice(list, func(i, j int) bool {
		return list[i].String() < list[j].String()
	})
	muListKeyEncryptionAlgorithm.Lock()
	listKeyEncryptionAlgorithm = list
	muListKeyEncryptionAlgorithm.Unlock()
}

// KeyEncryptionAlgorithms returns a list of all available values for KeyEncryptionAlgorithm
func KeyEncryptionAlgorithms() []KeyEncryptionAlgorithm {
	muListKeyEncryptionAlgorithm.RLock()
	defer muListKeyEncryptionAlgorithm.RUnlock()
	return listKeyEncryptionAlgorithm
}

// MarshalJSON serializes the KeyEncryptionAlgorithm object to a JSON string
func (s KeyEncryptionAlgorithm) MarshalJSON() ([]byte, error) {
	return json.Marshal(s.String())
}

// UnmarshalJSON deserializes the JSON string to a KeyEncryptionAlgorithm object
func (s *KeyEncryptionAlgorithm) UnmarshalJSON(data []byte) error {
	var name string
	if err := json.Unmarshal(data, &name); err != nil {
		return fmt.Errorf(`failed to unmarshal KeyEncryptionAlgorithm: %w`, err)
	}
	v, ok := LookupKeyEncryptionAlgorithm(name)
	if !ok {
		return fmt.Errorf(`unknown KeyEncryptionAlgorithm: %s`, name)
	}
	*s = v
	return nil
}
